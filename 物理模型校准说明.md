# 物理模型校准说明

本文档用于说明本项目的三项物理基准测试（benchmark）如何设计、如何执行，以及校准结果如何解读。目标是验证 1D 圆柱 PIC‑MCC 核心求解器在**静电场求解、电子温度统计、离子 OML 动力学**三个关键方面的物理正确性。

---

## 校准目标

1. **电场求解正确性**：验证圆柱 Poisson 求解器是否正确处理 `1/r` 几何项。  
2. **电子温度统计正确性**：验证速度采样与 Boltzmann 关系在弱扰动区的正确性。  
3. **离子 OML 动力学一致性**：验证离子轨道运动与角动量守恒对 I‑V 形状的影响。

---

## 选择这三个 Benchmark 的原因

1. **真空圆柱电容器 (Test 1)**  
   这是 Poisson 求解器的“解析可比”金标准。  
   解析解直接包含 `ln(r)` 形式，是检验 `1/r` 几何项的最低成本方法。  

2. **电子温度检查 (Test 2)**  
   低压、无碰撞、电子 retarding 区的 `ln(I_e)` 应与电压线性，斜率 `≈ 1/Te`。  
   这是验证电子速度分布采样、注入通量分布修正的核心测试。  

3. **OML 离子动力学 (Test 3)**  
   OML 理论中圆柱探针满足 `I_i^2 ∝ |V|`。  
   它检验离子推进的角动量守恒、轨道聚焦行为是否合理。  

这三个基准覆盖：**场求解、粒子统计、动力学行为**三大核心模块。

---

## Benchmark 1：真空圆柱电容器

**目的**：验证 Poisson 求解器的 `1/r` 项。  
**配置**：
- 无粒子（密度为 0）
- `r_min = 0.5 mm`, `r_max = 5.0 mm`
- `φ(r_min) = -100 V`, `φ(r_max) = 0 V`

**解析解**：
```
φ(r) = V_bias * ln(r/r_max) / ln(r_min/r_max)
```

**结果**：
```
Max relative error ≈ 0.0017%
```
说明数值解与解析解高度一致，圆柱几何项实现正确。

输出文件：
- `results/benchmark_test1_vacuum_capacitor.png`
- `results/benchmark_test1_vacuum_capacitor.csv`

---

## Benchmark 2：电子温度检查

**目的**：验证电子速度采样与 Boltzmann 关系。  
**配置**：
- 无碰撞：`P_Torr = 0`
- `Te = 2.0 eV`, `N0 = 1e15 m^-3`
- 扫描 `V_bias = -10 → -2 V`
- 使用 `ln(I_e)` 线性拟合

**理论预期**：
```
ln(I_e) ∝ (e/kTe) * V_bias
```
斜率理论值约 `1/Te = 0.5`。

**校准结果**：
```
ln(I_e) slope ≈ 0.496
Inferred Te ≈ 2.01 eV
```
说明采样已能正确反映 Maxwellian 斜率。  
这一结果是在将电子注入修正为**通量分布采样**后达到的。

输出文件：
- `results/benchmark_test2_electron_temperature.png`
- `results/benchmark_test2_electron_temperature.csv`

---

## Benchmark 3：OML 离子动力学

**目的**：验证离子轨道运动对 `I_i^2 ∝ |V|` 的线性关系。  
**配置（调整后）**：
- `R_MAX` 缩小以减少离子飞行时间  
- `N0` 增大以提高命中统计  
- `n_particles` 增加  
- `n_burn_in` 与 `n_sampling` 大幅提高  
- 无碰撞 `P_Torr = 0`

**理论预期**：
```
I_i^2 ∝ |V_bias|
```

**当前校准结果**：
```
R^2 ≈ 0.301
```
说明：趋势出现，但线性度仍不足。原因主要是：
1. 离子跨域时间仍较长，完全稳态需要更多步数。  
2. 低偏压点仍偏离深 OML 区间。  
3. 统计噪声依然明显（尤其在 |V| 较小区间）。  

因此，OML benchmark 目前属于“部分通过”。  
建议后续将拟合区间限制在深负偏压区，或进一步缩小 `R_MIN` 与 `R_MAX` 提高 OML 条件满足度。

输出文件：
- `results/benchmark_test3_oml_ion.png`
- `results/benchmark_test3_oml_ion.csv`

---

## 总体结论

- **Poisson 圆柱求解器通过验证**（误差 < 0.01%）。
- **电子温度基准通过验证**（推断 Te 与输入一致）。
- **离子 OML 基准部分通过**，说明动力学趋势正确，但仍需进一步提升稳态与统计质量。

这三项基准共同说明：**核心求解器的物理正确性已建立**，在高压 I‑V 扫描之前，数值模型已具备可信基础。

---

如需继续提升 OML 校准质量，可考虑：
- 进一步增大 `n_sampling` / `n_burn_in`  
- 仅拟合 `V <= -30 V` 区间  
- 减小 `R_MIN` 或降低 `N0` 使 `r_p << λ_D` 更严格成立
